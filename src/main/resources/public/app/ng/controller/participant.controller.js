angular.module("run_proud").controller("ParticipantController",["$rootScope","$scope","$state","$stateParams","$cookies","$timeout","$filter","Access","RunEventDataOp",function(t,i,r,e,s,n,a,o,u){i.user=null,i.selectedItem={},i.categories=[],i.participants={data:[],currentPageList:[],filteredList:[],totalItems:0,numPages:5,maxSize:5,currentPage:1,boundary_links:!0,numPerPage:10,numPerPageSelections:[5,10,20,50,100],pageChange:function(){var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},searchKeyword:"",search:function(){this.filteredList=a("filter")(this.data,this.searchKeyword),this.totalItems=this.filteredList.length;var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},numPageChange:function(){var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},init:function(t){this.data=t,this.totalItems=t.length,this.filteredList=t,this.filteredList=a("filter")(this.data,this.searchKeyword);var e=(this.currentPage-1)*this.numPerPage,i=e+this.numPerPage;this.currentPageList=this.filteredList.slice(e,i)}},i.getRunEventParticipants=function(t){u.getRunEventParticipants(t).then(function(t){i.participants.init(t.data)}).catch(function(t){console.log(t)})},i.showChangeCateg=function(t){$("#edit-category").modal("show")},i.isAdmin=function(){return!!i.user&&"ADMIN"==i.user.role},i.start=function(){i.$emit("childEmit",i.user),console.log(e.eventId),i.getRunEventParticipants(e.eventId)},i.checkUser=function(t){if(o.user)i.user=o.user,i.start();else{var e=s.get("run_proud_token");e?o.getClaimsFromToken(e,function(t){i.user=t.data.principal.user,i.start()},function(t){console.log(t),o.clearData(),s.remove("run_proud_token"),r.go("login")}):r.go("login")}},i.checkUser(i.start)}]);