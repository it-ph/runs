angular.module("run_proud").controller("LandingPageController",["$rootScope","$scope","$state","$timeout","$filter","RunEventDataOp",function(t,r,e,i,s,a){r.all_run_progress={data:[],currentPageList:[],filteredList:[],totalItems:0,numPages:5,maxSize:5,currentPage:1,boundary_links:!0,numPerPage:10,numPerPageSelections:[5,10,20,50,100],categories:["ALL","BLITZ","RANGE I","BLITZ RANGE I","RANGE II","BLITZ RANGE II","RANGE III","FULL METAL"],category:"ALL",facilityProgressPercent:{},pageChange:function(){var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},searchKeyword:"",search:function(){this.filteredList=s("filter")(this.data,this.searchKeyword),this.totalItems=this.filteredList.length;var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},numPageChange:function(){var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},init:function(t){this.data=t,this.totalItems=t.length,this.filteredList=t,this.filteredList=s("filter")(this.data,this.searchKeyword);var e=(this.currentPage-1)*this.numPerPage,n=e+this.numPerPage;this.currentPageList=this.filteredList.slice(e,n)},filterByCategory:function(){this.filteredList=s("categFilter")(this.data,this.category),this.totalItems=this.filteredList.length;var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)}},r.austin_run_progress=angular.copy(r.all_run_progress),r.coimbatore_run_progress=angular.copy(r.all_run_progress),r.gurugram_run_progress=angular.copy(r.all_run_progress),r.manila_run_progress=angular.copy(r.all_run_progress),r.facilities=["MANILA","GURUGRAM","COIMBATORE","AUSTIN"],r.countRemaining={days:0,hours:0,minutes:0,seconds:0},r.runEvent={},r.event_start_tick=function(){eventStart=moment(runEvent.regStart),currentTime=moment(new Date),eventRem=moment.duration(eventStart.diff(currentTime)),eventRem._milliseconds},r.countRemaining={},r.tickEnd=function(){var t=moment(r.runEvent.runEnd),e=moment(new Date),n=moment.duration(t.diff(e));0<n._milliseconds&&(r.countRemaining={days:n.days(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),event_msg:"Run Ends"},i(r.tickEnd,1e3))},r.tickRun=function(){var t=moment(r.runEvent.runStart),e=moment(new Date),n=moment.duration(t.diff(e));0<n._milliseconds?(r.countRemaining={days:n.days(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),event_msg:"Run Starts"},i(r.tickRun,1e3)):r.tickEnd()},r.tickReg=function(){var t=moment(r.runEvent.regStart),e=moment(new Date),n=moment.duration(t.diff(e));0<n._milliseconds?(r.countRemaining={days:n.days(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),event_msg:"Registration Starts"},i(r.tickReg,1e3)):r.tickRun()},r.getRunRecords=function(t,e,n){a.getAllProgressByEventyByFacility(t,e).then(function(t){n(t.data)}).catch(function(t){console.log(t)})},r.getAllRunRecords=function(t,e){a.getAllProgressByEvent(t).then(function(t){e(t.data)}).catch(function(t){console.log(t)})},r.getFacilityProgressPercent=function(t,e,n){a.getFacilityProgressPercent(t,e).then(function(t){t.data.percent=Math.round(t.data.totalUserDistance/t.data.totalCategoryDistance*100),n(t.data)}).catch(function(t){console.log(t)})},r.start=function(t){(r.runEvent=t).runStart&&(r.getAllRunRecords(t.id,function(t){0<t.length&&r.all_run_progress.init(t)}),r.getRunRecords(t.id,"AUSTIN",function(t){0<t.length&&r.austin_run_progress.init(t)}),r.getRunRecords(t.id,"COIMBATORE",function(t){0<t.length&&r.coimbatore_run_progress.init(t)}),r.getRunRecords(t.id,"GURUGRAM",function(t){0<t.length&&r.gurugram_run_progress.init(t)}),r.getRunRecords(t.id,"MANILA",function(t){0<t.length&&r.manila_run_progress.init(t)}),r.getFacilityProgressPercent(t.id,"AUSTIN",function(t){r.austin_run_progress.facilityProgressPercent=t}),r.getFacilityProgressPercent(t.id,"COIMBATORE",function(t){r.coimbatore_run_progress.facilityProgressPercent=t}),r.getFacilityProgressPercent(t.id,"GURUGRAM",function(t){r.gurugram_run_progress.facilityProgressPercent=t}),r.getFacilityProgressPercent(t.id,"MANILA",function(t){r.manila_run_progress.facilityProgressPercent=t}),r.tickReg())},r.getAllProgressByEventyByFacility=function(){},r.init=function(){a.getCurrentRun().then(function(t){r.start(t.data)}).catch(function(t){console.log(t)})},r.init(),r.scroll=function(t){t?$("html, body").animate({scrollTop:$(t).offset().top-49},600):$("html, body").animate({scrollTop:0},600)}}]);