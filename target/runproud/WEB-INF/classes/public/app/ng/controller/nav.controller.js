angular.module("run_proud").controller("NavController",["$rootScope","$scope","$state","$cookies","$http","Access","NotifDataOp",function(o,t,e,n,s,i,r){t.user=void 0,t.newPassword={},t.error=void 0,t.notif=[],t.showChangePassModal=function(){t.error=void 0,t.newPassword={},$("#update-password").modal("show")},t.changePassword=function(){t.newPassword.password.length<7&&(t.error="Password must not be less than 7 characters"),t.newPassword.password!=t.newPassword.confirm_password&&(t.error="Passwords mismatched"),t.error||(user_data={password:t.newPassword.password},i.changePassword(user_data).then(function(o){$("#update-password").modal("hide")}).catch(function(o){t.error="Oops, something went wrong!"}))},t.getNotifications=function(){r.getNotification().then(function(o){t.notif=o.data}).catch(function(o){console.log(o)})},t.viewNotif=function(n){r.viewNotif(n).then(function(o){t.getNotifications(),e.go(n.click_action)}).catch(function(o){console.log(o)})},t.viewAll=function(){r.viewAll(t.notif).then(function(o){t.getNotifications()}).catch(function(o){console.log(o)})},t.logout=function(){n.remove("run_proud_token"),i.logout(),e.go("login")},t.init=function(){t.getNotifications()},t.checkUser=function(){if(i.user)t.user=i.user,t.init();else{var o=n.get("run_proud_token");o?i.getClaimsFromToken(o,function(o){t.user=o.data.principal.user,t.init()},function(o){console.log(o)}):e.go("login")}},t.checkUser()}]);