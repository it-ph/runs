angular.module("run_proud").controller("RegistrationController",["$rootScope","$scope","$state","$cookies","$http","$filter","Access","RegistrationDataOp",function(t,i,n,s,e,r,a,o){i.user=null,i.isAdmin=function(){return!!i.user&&"ADMIN"==i.user.role},i.approve=function(t){$("#loading").modal("show"),o.approve(t).then(function(t){i.getRegistrations(),$("#loading").modal("hide")}).catch(function(t){$("#loading").modal("hide"),console.log(t)})},i.deleteUserReg=function(t){$("#loading").modal("show"),o.deleteUserReg(t).then(function(t){i.getRegistrations(),$("#loading").modal("hide")}).catch(function(t){$("#loading").modal("hide"),console.log(t)})},i.getRegistrations=function(){o.getRegistrations().then(function(t){i.registrations.init(t.data),i.registrations.data}).catch(function(t){console.log(t)})},i.start=function(){i.$emit("childEmit",i.user),i.registrations={data:[],currentPageList:[],filteredList:[],totalItems:0,numPages:void 0,maxSize:5,currentPage:1,boundary_links:!0,numPerPage:10,numPerPageSelections:[5,10,20,50,100],pageChange:function(){var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},searchKeyword:"",search:function(){this.filteredList=r("filter")(this.data,this.searchKeyword),this.totalItems=this.filteredList.length;var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},numPageChange:function(){var t=(this.currentPage-1)*this.numPerPage,e=t+this.numPerPage;this.currentPageList=this.filteredList.slice(t,e)},init:function(t){this.data=t,this.totalItems=t.length,this.filteredList=t;var e=(this.currentPage-1)*this.numPerPage,i=e+this.numPerPage;this.currentPageList=this.filteredList.slice(e,i)}},i.getRegistrations()},i.checkUser=function(t){if(a.user)i.user=a.user,i.start();else{var e=s.get("run_proud_token");e?a.getClaimsFromToken(e,function(t){i.user=t.data.principal.user,i.start()},function(t){console.log(t),a.clearData(),s.remove("run_proud_token"),n.go("login")}):n.go("login")}},i.checkUser(i.start)}]);